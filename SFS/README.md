## Repository Structure
The repository is organized into several directories to separate the different components of the project, making navigation and maintenance easier.

- `include/` : Contains the C header files that declare the functions, macros, data types, and parameter values used in the C source files.
- `src/` : Contains the C source files that simulate the replication and degradation of mtDNA molecules within a cell.
- `data_analysis/` : Contains the Python scripts used to analyze the data generated by the simulations.

### Usage Example
If you want to manually run a few simulations, but most of the work was done with the `.pbs` scripts:
1. **Compile the C programs**
    - Navigate to the `src/` directory:
    ```bash
    cd src
    ```
    - Compile the source files:
    ```bash
    gcc ra_single_sim.c lib_sim.c -o ra_single_sim.exe -lgsl -lgslcblas -lm
    ```
2. **Run the simulations**
    ```bash
    ./ra_single_sim.exe 1
    ./ra_single_sim.exe 2
    ```
    Here, two simulations with seeds 1 and 2 under the replicative advantage (RA) model are performed using the parameter values specified in `include/parameters.h`. A new directory `src/parameters_set1` is created, containing the simulation results: `ra_sim_populations1.txt`, `ra_sim_site_frequency_spectrum1.txt`, `ra_sim_populations2.txt`, `ra_sim_site_frequency_spectrum2.txt`, as well as a list of parameter values `parameters.txt`.

### Data Analysis
1. **Copy the simulation data to the data analysis directory**
    ```bash
    cd
    cp src/parameters_set1/ra_sim*.txt data_analysis/
    cd data_analysis
    ```
2. **Compile the simulation data**
    ```bash
    python compile_data.py 1 ra pop
    python compile_data.py 1 ra sfs
    ```
    The Pandas dataframes `parameters_set1_ra_pop_master.pkl` and `parameters_set1_ra_sfs_master.pkl` are generated and saved. These dataframes contain the compiled data from the two simulations.
3. **Combine population data and site frequency spectrum**
    ```bash
    python combine_pop_sfs.py 1 ra
    ```
    The Pandas dataframe `parameters_set1_ra_combined_master.pkl` is generated and saved.
4. **Ensemble Data**
    ```bash
    python ensemble_data.py 1 ra 1.0
    ```
    The Pandas dataframes `parameters_set1_ra_h_100.pkl` and `parameters_set1_ra_sfs_100.pkl`, containing the fraction of mutants and the site frequency spectrum across the simulations, are generated. These dataframes are typically small and can be copied to your local machine.
5. **Visualize the Data**
    - Plot the fraction of mutants over time:
    ```bash
    python example_plot_h.py
    ```
    - Plot the site frequency spectrum:
    ```bash
    python example_plot_sfs.py
    ```
6. **Perform Statistical Tests**
   
    Suppose that, in addition to the RA model simulations, the above steps are also followed to simulate, compile, and assemble the data under the Stochastic Survival of the Densest (SSD) model, obtaining the Pandas dataframe `parameters_set1_ssd_sfs_100.pkl`. Then, the following command can be executed to perform a Mann-Whitney U test on the difference in site frequency spectra between the RA and SSD models:
    ```bash
    python example_mann-whitney.py
    ```
